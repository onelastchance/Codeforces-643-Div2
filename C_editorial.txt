Since x≤y≤z to be a non-degenerate triangle for given triple it is necessary and sufficient to satisfy z<x+y. Let's calculate for all s=x+y how many ways there are to choose (x,y). To do that we will try all x and add 1 on segment [x+B;x+C] offline using prefix sums. Let's calculate prefix sums once more, now we can find in O(1) how many ways there are to choose (x,y) such that their sum if greater than z. Try all z, calculate the answer. Total complexity — O(C).